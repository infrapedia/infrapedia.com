{"version":3,"sources":["webpack:///./src/components/dialogs/AlertsDialog.vue?a67e","webpack:///src/components/dialogs/AlertsDialog.vue","webpack:///./src/components/dialogs/AlertsDialog.vue?466b","webpack:///./src/components/dialogs/AlertsDialog.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","isVisible","customDialogClass","on","$event","staticClass","slot","_v","directives","name","rawName","value","expression","ref","class","dark","model","form","callback","$$v","$set","validatePhoneNumber","phone","num","valid","_e","siteKey","handleCatchaVerification","catchaVerified","closeDialog","isFormUncomplete","isSendingData","submitForm","type","indexOf","_k","keyCode","key","staticRenderFns","components","VueRecaptcha","data","computed","get","$store","state","isAlertDialog","set","emptyFields","length","watch","bool","$refs","catpcha","reset","setUserData","methods","v","number","isValid","commit","email","component"],"mappings":"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","file":"js/chunk-2d2169e3.d8e5e02e.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{attrs:{\"visible\":_vm.isVisible,\"width\":\"40%\",\"top\":\"12vh\",\"custom-class\":_vm.customDialogClass,\"close-on-click-modal\":false},on:{\"update:visible\":function($event){_vm.isVisible=$event}}},[_c('header',{staticClass:\"header p0 no-selectable\",attrs:{\"slot\":\"title\"},slot:\"title\"},[_c('h1',{staticClass:\"inline-block font-semibold fs-xlarge\"},[_c('span',{staticClass:\"capitalize\"},[_vm._v(\"Create Alert\")])])]),_c('el-form',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],ref:\"form\",staticClass:\"pr2 pl2\"},[_c('el-row',{attrs:{\"gutter\":15}},[_c('el-col',{attrs:{\"md\":24,\"lg\":12,\"xl\":12}},[_c('el-form-item',{attrs:{\"label\":\"Email\",\"prop\":\"company\"}},[_c('el-input',{class:{ dark: _vm.dark },model:{value:(_vm.form.email),callback:function ($$v) {_vm.$set(_vm.form, \"email\", $$v)},expression:\"form.email\"}})],1)],1),_c('el-col',{attrs:{\"md\":24,\"lg\":12,\"xl\":12}},[_c('el-form-item',{attrs:{\"label\":\"Phone number\"}},[_c('div',{staticClass:\"el-input\"},[_c('i-phone-input',{staticClass:\"m0 p0 el-input__inner\",attrs:{\"inputClasses\":\"el-input__inner issues-dialog\"},on:{\"onInput\":_vm.validatePhoneNumber},model:{value:(_vm.form.phone.num),callback:function ($$v) {_vm.$set(_vm.form.phone, \"num\", $$v)},expression:\"form.phone.num\"}})],1),_c('el-collapse-transition',[(_vm.form.phone.num && !_vm.form.phone.valid)?_c('el-alert',{staticClass:\"mt2 h8\",attrs:{\"type\":\"error\",\"show-icon\":\"\",\"title\":\"This phone number is not valid\",\"closable\":false}}):_vm._e()],1)],1)],1),_c('el-col',{attrs:{\"span\":24}},[_c('vue-recaptcha',{ref:\"catpcha\",attrs:{\"sitekey\":_vm.siteKey,\"loadRecaptchaScript\":true},on:{\"verify\":_vm.handleCatchaVerification,\"error\":function () { return (_vm.catchaVerified = false); },\"expired\":function () { return (_vm.catchaVerified = false); }}})],1)],1)],1),_c('footer',{staticClass:\"footer flex wrap justify-content-end pr0 pl6 mt4\"},[_c('div',[_c('el-button',{staticClass:\"mr2\",attrs:{\"plain\":\"\",\"type\":\"info\"},on:{\"click\":_vm.closeDialog}},[_vm._v(\"Cancel\")]),_c('el-button',{staticClass:\"w28\",attrs:{\"disabled\":_vm.isFormUncomplete,\"type\":\"primary\",\"plain\":\"\",\"loading\":_vm.isSendingData},on:{\"click\":_vm.submitForm,\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")&&_vm._k($event.keyCode,\"space\",32,$event.key,[\" \",\"Spacebar\"])){ return null; }return _vm.submitForm($event)}}},[_vm._v(\" Sign in \")])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <el-dialog\n    :visible.sync=\"isVisible\"\n    width=\"40%\"\n    top=\"12vh\"\n    :custom-class=\"customDialogClass\"\n    :close-on-click-modal=\"false\"\n  >\n    <header slot=\"title\" class=\"header p0 no-selectable\">\n      <h1 class=\"inline-block font-semibold fs-xlarge\">\n        <span class=\"capitalize\">Create Alert</span>\n      </h1>\n    </header>\n    <el-form class=\"pr2 pl2\" ref=\"form\" v-loading=\"loading\">\n      <el-row :gutter=\"15\">\n        <el-col :md=\"24\" :lg=\"12\" :xl=\"12\">\n          <el-form-item label=\"Email\" prop=\"company\">\n            <el-input v-model=\"form.email\" :class=\"{ dark }\" />\n          </el-form-item>\n        </el-col>\n        <el-col :md=\"24\" :lg=\"12\" :xl=\"12\">\n          <el-form-item label=\"Phone number\">\n            <div class=\"el-input\">\n              <i-phone-input\n                inputClasses=\"el-input__inner issues-dialog\"\n                v-model=\"form.phone.num\"\n                @onInput=\"validatePhoneNumber\"\n                class=\"m0 p0 el-input__inner\"\n              />\n            </div>\n            <el-collapse-transition>\n              <el-alert\n                type=\"error\"\n                class=\"mt2 h8\"\n                show-icon\n                title=\"This phone number is not valid\"\n                :closable=\"false\"\n                v-if=\"form.phone.num && !form.phone.valid\"\n              />\n            </el-collapse-transition>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"24\">\n          <vue-recaptcha\n            ref=\"catpcha\"\n            :sitekey=\"siteKey\"\n            :loadRecaptchaScript=\"true\"\n            @verify=\"handleCatchaVerification\"\n            @error=\"() => (catchaVerified = false)\"\n            @expired=\"() => (catchaVerified = false)\"\n          />\n        </el-col>\n      </el-row>\n    </el-form>\n    <footer class=\"footer flex wrap justify-content-end pr0 pl6 mt4\">\n      <div>\n        <el-button plain type=\"info\" class=\"mr2\" @click=\"closeDialog\"\n          >Cancel</el-button\n        >\n        <el-button\n          :disabled=\"isFormUncomplete\"\n          type=\"primary\"\n          class=\"w28\"\n          plain\n          @click=\"submitForm\"\n          :loading=\"isSendingData\"\n          @keyup.enter.space=\"submitForm\"\n        >\n          Sign in\n        </el-button>\n      </div>\n    </footer>\n  </el-dialog>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport { getUserData } from '../../services/api/auth'\nimport { createAlert } from '../../services/api/alerts'\nimport { TOGGLE_ALERT_DIALOG } from '../../store/actionTypes'\nimport { getSelectionTypeNumber } from '../../helpers/getSelectionTypeNumber'\nimport VueRecaptcha from 'vue-recaptcha'\nimport siteKey from '../../config/siteKey'\n\nexport default {\n  components: {\n    VueRecaptcha\n  },\n  data: () => ({\n    isSendingData: false,\n    catchaVerified: null,\n    loading: false,\n    siteKey,\n    form: {\n      email: '',\n      phone: {\n        num: '',\n        valid: null\n      }\n    }\n  }),\n  computed: {\n    ...mapState({\n      focus: state => state.map.focus,\n      dark: state => state.isDark\n    }),\n    isVisible: {\n      get() {\n        return this.$store.state.isAlertDialog\n      },\n      set() {\n        return this.closeDialog()\n      }\n    },\n    isFormUncomplete() {\n      const emptyFields = Object.keys(this.form).filter(key => !this.form[key])\n      return emptyFields.length || !this.catchaVerified ? true : false\n    },\n    customDialogClass() {\n      return this.dark ? 'alerts-dialog dark' : 'alerts-dialog light'\n    }\n  },\n  watch: {\n    isVisible(bool) {\n      if (!bool) return this.$refs.catpcha.reset()\n      this.setUserData()\n    }\n  },\n  methods: {\n    handleCatchaVerification(v) {\n      if (!v) return\n      else this.catchaVerified = true\n    },\n    async setUserData() {\n      if (!this.$auth.user) return\n      this.loading = true\n      const userData = await getUserData(await this.$auth.getUserID())\n\n      if (userData) {\n        const { user_metadata } = userData\n\n        this.form.email =\n          user_metadata && user_metadata.email\n            ? user_metadata.email\n            : userData.email\n        this.form.phone =\n          user_metadata && user_metadata.phonenumber\n            ? user_metadata.phonenumber\n            : {\n                num: '',\n                valid: null\n              }\n      }\n      this.loading = false\n    },\n    validatePhoneNumber({ number, isValid }) {\n      try {\n        this.form.phone = {\n          num: number,\n          valid: isValid\n        }\n      } catch {\n        // Ignore\n      }\n    },\n    async submitForm() {\n      this.isSendingData = true\n      const res = await createAlert({\n        user_id: await this.$auth.getUserID(),\n        elemnt: this.focus.id,\n        t: getSelectionTypeNumber(this.focus.type),\n        ...this.form\n      })\n      if (res && res.t && res.t !== 'error') this.closeDialog()\n      this.isSendingData = false\n    },\n    closeDialog() {\n      this.$store.commit(`${TOGGLE_ALERT_DIALOG}`, false)\n      this.form = {\n        email: '',\n        phone: {\n          num: '',\n          valid: null\n        }\n      }\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlertsDialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlertsDialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AlertsDialog.vue?vue&type=template&id=4c89e434&\"\nimport script from \"./AlertsDialog.vue?vue&type=script&lang=js&\"\nexport * from \"./AlertsDialog.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}